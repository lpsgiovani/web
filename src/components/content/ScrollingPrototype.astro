---
import { Image } from 'astro:assets';

const { 
    src, 
    url, 
    alt = "Live Preview", 
    height = "h-[600px]", 
    title = "LIVE_SYSTEM_OVERRIDE" 
} = Astro.props;
---

<div class="my-32 w-full reveal-up">
    {/* Terminal Header */}
    <div class="bg-zinc-900/50 rounded-t-lg border-x border-t border-zinc-800 p-3 flex items-center justify-between">
        <div class="flex gap-1.5">
            <div class="w-2.5 h-2.5 rounded-full bg-zinc-800"></div>
            <div class="w-2.5 h-2.5 rounded-full bg-zinc-800"></div>
            <div class="w-2.5 h-2.5 rounded-full bg-zinc-800"></div>
        </div>
        <div class="font-mono text-[10px] text-zinc-500 tracking-[0.2em] flex items-center gap-4">
             <span class="animate-pulse">‚óè</span>
             {title}
             <span class="opacity-30">|</span>
             {url ? url.replace('https://', '') : 'INTERNAL_ASSET'}
        </div>
        <div class="w-12"></div> {/* Spacer */}
    </div>

    {/* Content Area */}
    <div class={`relative w-full ${height} overflow-hidden border-x border-b border-zinc-900 rounded-b-lg bg-black group`}>
        {url ? (
            /* Iframe View */
            <iframe 
                src={url} 
                class="w-full h-full border-none opacity-90 group-hover:opacity-100 transition-all duration-700" 
                title={alt}
                loading="lazy"
                sandbox="allow-scripts allow-same-origin"
            ></iframe>
        ) : src ? (
            /* Image Scroll View */
            <div class="w-full h-full overflow-y-auto overflow-x-hidden scrollbar-hide">
                 <Image 
                    src={src} 
                    alt={alt}
                    class="w-full h-auto transition-all duration-1000"
                 />
            </div>
        ) : null}

        {/* Scanline Overlay */}
        <div class="absolute inset-0 pointer-events-none bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.1)_50%)] bg-[length:100%_2px] opacity-20"></div>
        <div class="absolute inset-0 pointer-events-none border border-white/5 group-hover:border-white/10 transition-colors"></div>
    </div>
    
    <div class="mt-4 flex justify-between items-center text-[9px] font-mono text-zinc-600 uppercase tracking-widest">
        <span>STATUS: ACTIVE_LINK</span>
        <span>RESOLUTION: 1920x1080_AUTO</span>
    </div>
</div>

<style>
    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }
    .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
</style>
