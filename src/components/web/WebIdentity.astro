---
// WebIdentity.astro - Identity Translation Section
---

<section id="identity" class="bg-black text-white min-h-screen flex flex-col justify-center py-24 md:py-40 px-6 border-b border-zinc-900 relative overflow-hidden">
    {/* Background Grid Pattern - Subtle */}
    <div class="absolute inset-0 opacity-[0.03] pointer-events-none" style="background-image: linear-gradient(#fff 1px, transparent 1px), linear-gradient(90deg, #fff 1px, transparent 1px); background-size: 40px 40px;"></div>
    
    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-12 items-start relative z-10">
        
        {/* Left Column: Title */}
        <div class="lg:col-span-7 reveal-up">
            <span class="font-mono text-[10px] uppercase tracking-[0.5em] text-zinc-500 block mb-6">/ MANIFESTO_01</span>
            <h2 class="text-4xl md:text-7xl lg:text-8xl font-display leading-[0.9] tracking-tighter uppercase mb-8">
                AUTORIDADE<br />
                <span class="text-zinc-600">NÃO SE ENCONTRA</span> <br />
                NA PRATELEIRA.
            </h2>
        </div>

        {/* Right Column: Content */}
        <div class="lg:col-span-5 lg:pt-12 flex flex-col gap-8 reveal-up delay-200">
            <p class="text-lg md:text-2xl font-light leading-relaxed text-zinc-300">
                Existe um abismo entre a qualidade do que você entrega e a forma como o mercado te enxerga. 
            </p>
            <div class="space-y-6 text-base md:text-xl font-light leading-relaxed text-zinc-500">
                <p>
                    Se sua presença digital não traduz sua essência, ela se torna um <span class="text-white font-normal">obstáculo.</span>
                </p>
                <p>
                    Nós construímos o que não pode ser copiado: <span class="text-zinc-300">arquiteturas de autoridade que unem design e engenharia para sua marca dominar o mercado.</span>
                </p>
            </div>

            {/* Technical Detail Label */}
            <div class="mt-8 flex items-center gap-4 font-mono text-[10px] tracking-widest text-zinc-700 uppercase">
                <div class="w-12 h-px bg-zinc-800"></div>
                <span>NOS RECUSAMOS A FICAR NA MÉDIA</span>
            </div>
        </div>

    </div>
</section>

<style>
    .reveal-up {
        opacity: 0;
        transform: translateY(30px);
        transition: all 1s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .reveal-up.active {
        opacity: 1;
        transform: translateY(0);
    }
</style>

<script>
    const setupIdentity = () => {
        const observerOptions = {
            threshold: 0.15,
            rootMargin: "0px 0px -50px 0px"
        };

        const revealObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                    revealObserver.unobserve(entry.target);
                }
            });
        }, observerOptions);

        document.querySelectorAll('.reveal-up').forEach(el => {
            revealObserver.observe(el);
        });

        // --- Auto Scroll to Expertise Logic ---
        const identitySection = document.getElementById('identity');
        let scrollActive = false;

        if (identitySection) {
            const scrollToExpertise = () => {
                const nextSection = document.getElementById('expertise');
                if (nextSection) {
                    nextSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            };

            const handleWheel = (e) => {
                if (scrollActive) return;

                // Check if user is viewing Identity section
                const rect = identitySection.getBoundingClientRect();
                const isViewable = rect.top >= -50 && rect.bottom <= (window.innerHeight + 50);
                
                // If viewing identity and scrolling down
                if (isViewable && e.deltaY > 0) {
                    e.preventDefault();
                    scrollActive = true;
                    scrollToExpertise();
                    setTimeout(() => { scrollActive = false; }, 1500); // Debounce
                }
            };

            let touchStartY = 0;
            const handleTouchStart = (e) => { touchStartY = e.touches[0].clientY; };
            
            const handleTouchMove = (e) => {
                if (scrollActive) return;
                
                const touchEndY = e.touches[0].clientY;
                const touchDiff = touchStartY - touchEndY;

                // Check visibility
                const rect = identitySection.getBoundingClientRect();
                const isViewable = rect.top >= -100 && rect.bottom <= (window.innerHeight + 100);

                // Swipe UP (Scroll Down)
                if (isViewable && touchDiff > 30) {
                    scrollActive = true;
                    scrollToExpertise();
                    setTimeout(() => { scrollActive = false; }, 1500);
                }
            };

            // Enable listeners only when Identity is in view to save performance? 
            // Better: Add listeners globally but check bounds inside handler, simpler for SPA.
            // Or add listeners to window specifically for this logic.
            
            // To be safe and avoid conflicts, we'll check if we are basically "centered" on this section.
            window.addEventListener('wheel', handleWheel, { passive: false }); // passive: false needed for preventDefault
            window.addEventListener('touchstart', handleTouchStart, { passive: true });
            window.addEventListener('touchmove', handleTouchMove, { passive: true });
        }
    };

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupIdentity);
    } else {
        setupIdentity();
    }
    document.addEventListener('astro:page-load', setupIdentity);
</script>
