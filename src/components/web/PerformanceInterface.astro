---
import PerformanceCounter from './PerformanceCounter';
import TerminalCTA from './TerminalCTA';
---

<section class="w-full py-24 md:py-40 px-6 bg-black border-t border-white/5 text-white overflow-hidden relative">
    {/* Background Detail - Subtle Grid Line */}
    <div class="absolute top-0 left-1/2 w-px h-full bg-zinc-900/40 hidden lg:block"></div>

    <div class="max-w-7xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-y-12 lg:gap-x-20 items-center">
            
            {/* 1. Título & Indicador (Order 1 em todos) */}
            <div class="order-1 lg:col-span-12 mb-12 md:mb-20 text-center flex flex-col items-center">
                <span class="font-mono text-[10px] uppercase tracking-[0.5em] text-zinc-500 block mb-6 reveal-up">/ PERFORMANCE</span>
                <h2 class="text-4xl md:text-7xl font-serif leading-[1.1] tracking-tighter reveal-up">
                    Velocidade não <br />
                    <span class="text-zinc-500 italic">é um detalhe.</span>
                </h2>
            </div>

            {/* 2. LADO ESQUERDO: A PROVA TÉCNICA (Order 2) */}
            <div class="order-2 lg:col-span-7 relative flex flex-col items-center">
                
                {/* The Window Container */}
                <div class="relative w-full reveal-up">
                    {/* Shadow Glow behind window */}
                    <div class="absolute inset-x-10 inset-y-10 bg-white/5 blur-[100px] rounded-full pointer-events-none"></div>
                    
                    <div class="relative bg-white border border-zinc-200 shadow-[20px_20px_60px_-15px_rgba(0,0,0,0.8)] rounded-2xl overflow-hidden transform lg:-rotate-1 transition-transform duration-700 hover:rotate-0">
                        
                        {/* Browser Header - Minimal */}
                        <div class="h-10 bg-zinc-50 border-b border-zinc-100 flex items-center px-4 gap-1.5">
                            <div class="flex gap-1.5">
                                <div class="w-2.5 h-2.5 rounded-full bg-zinc-200"></div>
                                <div class="w-2.5 h-2.5 rounded-full bg-zinc-200"></div>
                                <div class="w-2.5 h-2.5 rounded-full bg-zinc-200"></div>
                            </div>
                        </div>

                        {/* Content Area */}
                        <div class="p-8 md:p-12 lg:p-16 text-black">
                            <div class="grid grid-cols-3 gap-6 md:gap-8 lg:gap-12 relative z-10 text-center">
                                <PerformanceCounter client:visible label="Performance" delay={0} />
                                <PerformanceCounter client:visible label="Acessibilidade" delay={200} />
                                <PerformanceCounter client:visible label="SEO" delay={400} />
                            </div>
                        </div>

                        {/* Internal Label */}
                        <div class="absolute bottom-3 left-5 font-mono text-[7px] text-zinc-300 uppercase tracking-widest">
                            © Primitiva_Engineering
                        </div>
                    </div>

                    {/* Technical Stamp */}
                    <div class="absolute -top-4 -right-2 lg:-right-4 bg-black text-white px-3 py-1.5 font-mono text-[9px] md:text-xs uppercase tracking-widest transform rotate-3 shadow-2xl border border-white/20 z-30 font-bold">
                        [ FOCO EM OTIMIZAÇÃO MAXIMA ]
                    </div>
                </div>

                {/* Annotation Label below window */}
                <div class="hidden lg:block mt-8 font-mono text-[8px] uppercase tracking-[0.4em] text-zinc-700 opacity-40 text-center w-full">
                    DIAGNOSIS_SESSION // SCALE_1:1 // 100_PERCENT_RAW_POWER
                </div>
            </div>

            {/* 3. Subtexto (Order 3) */}
            <div class="order-3 lg:col-span-5 flex flex-col items-center lg:items-start text-center lg:text-left">
                <div class="space-y-4 text-zinc-400 font-normal text-sm md:text-base leading-relaxed max-w-sm reveal-up delay-200">
                    <p>
                        No mercado high-ticket, o tempo é o recurso mais valioso. Um site instantâneo não é apenas técnico; é uma <span class="text-white">estratégia de retenção de capital.</span>
                    </p>
                    <p>
                        Projetamos ecossistemas onde a sofisticação nunca sacrifica a velocidade. Entregamos a paz técnica para o seu negócio escalar sem limites.
                    </p>
                </div>
                
                {/* 4. CTA (Integrado aqui no desktop para melhor fluxo) */}
                <div class="mt-12 md:mt-16 pt-8 border-t border-zinc-900 w-full flex justify-center lg:justify-start reveal-up delay-300">
                    <TerminalCTA client:visible variant="light" text="[Agendar_Diagnóstico]" href="/contato/" />
                </div>
            </div>

        </div>
    </div>
</section>

<style>
    .reveal-up {
        opacity: 0;
        transform: translateY(15px);
        transition: all 0.7s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .reveal-up.active {
        opacity: 1;
        transform: translateY(0);
    }
</style>

<script>
    const setupPerformance = () => {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.reveal-up').forEach(el => observer.observe(el));
    };

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupPerformance);
    } else {
        setupPerformance();
    }
    document.addEventListener('astro:page-load', setupPerformance);
</script>
