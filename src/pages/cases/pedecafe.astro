---
export const prerender = true;
import WebLayout from '../../layouts/WebLayout.astro';
import { Image } from 'astro:assets';

// Case Study Components
import InterfaceShowcase from '../../components/content/InterfaceShowcase.astro';
import ComponentZoom from '../../components/content/ComponentZoom.astro';
import ScrollingPrototype from '../../components/content/ScrollingPrototype.astro';

// Hardcoded Assets for Pedecafe
// Using existing assets from the project structure
import coverImage from '../../content/projetos/assets/pedecafe.webp';
import mockup1 from '../../content/projetos/assets/pedecafe_mockup1.png';
import mockup2 from '../../content/projetos/assets/pedecafe_mockup2.png';
// import neonFluxCover from '../../content/projetos/assets/neon-flux.png';
// import oqfjfCover from '../../content/projetos/assets/oqfjf.webp';
import siteHeaderImage from '../../assets/cover/pedecafe_site_header.webp';
import siteHeaderImageMobile from '../../assets/cover/pedecafe_site_header_mobile.webp';
// Branding Assets
import asset1 from '@/assets/pedecafe/image/asset1.webp';
import asset2 from '@/assets/pedecafe/image/asset2.webp';
import comboDesktop from '@/assets/pedecafe/image/combo_desktop.webp';
import comboMobile from '@/assets/pedecafe/image/combo_mobile.webp';

const entry = {
  slug: "pedecafe",
  data: {
    title: "Pé de Café",
    description: "Identidade visual completa e website para uma cafeteria de cafés especiais focada em origem e pureza.",
    category: "Concurso de Cafeterias",
    client: "Pé de Café",
    year: "2025",
    techStack: ["NEXT.JS", "FIREBASE"],
    challenge: "O Pé de Café precisava de mais do que uma vitrine; precisava de uma infraestrutura robusta para um concurso que foi febre em JF. O desafio era criar um ecossistema digital que suportasse picos de tráfego, garantisse a integridade dos votos e oferecesse uma gestão de dados em tempo real.",
    outcome: "O Pé de Café agora possui uma base digital sólida que não apenas suporta o crescimento do concurso, mas o impulsiona através de dados precisos e uma experiência de usuário impecável."
  }
};

const title = `${entry.data.title} | Primitiva Cases`;
const description = entry.data.description;
---

<WebLayout title={title} description={description}>
    <fragment slot="head">
        <link rel="preload" href="/assets-dev/pedecafe/lottie/orbit_lite.webm" as="video" type="video/webm" crossorigin />
        <link rel="preload" href="/assets-dev/pedecafe/lottie/desktop/animation2.lottie" as="fetch" type="application/json" crossorigin />
        <link rel="preload" href="/assets-dev/pedecafe/lottie/mobile/slider_animation.lottie" as="fetch" type="application/json" crossorigin />
    </fragment>
    <script src="https://unpkg.com/@dotlottie/player-component@latest/dist/dotlottie-player.mjs" type="module"></script>
    <main class="bg-black min-h-screen text-white selection:bg-zinc-800 selection:text-white font-display">
        
        {/* Absolute Back Button (Inside Header) */}
        <div class="absolute top-6 left-6 md:top-12 md:left-12 z-50 reveal-up pointer-events-auto">
            <a 
                href="/" 
                class="group flex items-center gap-3 bg-white/5 hover:bg-white/10 backdrop-blur-md border border-white/10 px-4 py-2 md:px-6 md:py-3 rounded-full transition-all duration-300 hover:border-white/30"
            >
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-4 h-4 md:w-5 md:h-5 text-white transition-transform duration-300 group-hover:-translate-x-1">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" />
                </svg>
                <span class="font-mono text-[10px] md:text-xs uppercase tracking-[0.2em] text-white">Voltar</span>
            </a>
        </div>

        {/* 1. Full-Screen Intro (The Hook) & Technical Grid */}
        <section class="h-screen flex flex-col relative bg-[#0a101f] overflow-hidden">
             
             {/* Background Image - Immersive & Tinted */}
             <div class="absolute inset-0 z-0">
                 <Image 
                    src={coverImage}
                    alt="Background Texture"
                    class="w-full h-full object-cover opacity-60 mix-blend-overlay"
                 />
                 <div class="absolute inset-0 bg-blue-950/30 mix-blend-multiply"></div>
                 <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent"></div>
             </div>

             {/* Main Content Wrapper */}
             <div class="absolute inset-0 z-20 flex flex-col justify-end pointer-events-none">
                 
                 {/* Title Section */}
                 <div class="px-6 md:px-12 pb-12 w-full">
                     <div class="flex flex-col gap-6 reveal-up">
                         {/* Category Tag */}
                         <div class="flex items-center gap-3">
                             <div class="w-1.5 h-1.5 rounded-full bg-white"></div>
                             <span class="font-bold text-xs md:text-sm tracking-[0.2em] uppercase text-white/90">
                                 {entry.data.category}
                             </span>
                         </div>
                         
                         {/* Title Stacked */}
                         <h1 class="text-[clamp(4rem,15vw,12rem)] leading-[0.85] font-black tracking-tighter uppercase text-white drop-shadow-2xl">
                             PÉ DE<br/>CAFÉ
                         </h1>
                     </div>
                 </div>

                 {/* Technical Grid (Fixed at Bottom) */}
                 <div class="w-full border-t border-white/20 bg-black/60 backdrop-blur-md pointer-events-auto">
                    <div class="grid grid-cols-2 md:grid-cols-4 divide-x divide-y md:divide-y-0 divide-white/10">
                        {/* Cell 1: Year (Temporal Context) */}
                        <div class="p-4 md:p-6 flex flex-col gap-1 reveal-up">
                            <span class="font-mono text-[9px] uppercase tracking-widest text-zinc-400">ANO</span>
                            <span class="font-mono text-xs text-white font-bold uppercase">{entry.data.year}</span>
                        </div>
                        {/* Cell 2: Stack (Tech Differentiator) */}
                        <div class="p-4 md:p-6 flex flex-col gap-1 reveal-up delay-100">
                             <span class="font-mono text-[9px] uppercase tracking-widest text-zinc-400">STACK</span>
                             <span class="font-mono text-xs text-white font-bold uppercase">{entry.data.techStack.slice(0, 2).join(' + ')}</span>
                        </div>
                        {/* Cell 3: Services (Deliverables) */}
                        <div class="p-4 md:p-6 flex flex-col gap-1 reveal-up delay-200 col-span-2">
                             <span class="font-mono text-[9px] uppercase tracking-widest text-zinc-400">SERVIÇOS</span>
                             <span class="font-mono text-xs text-white font-bold uppercase">BRANDING, ID VISUAL & VERBAL, WEB (ECOSSISTEMA)</span>
                        </div>
                    </div>
                 </div>

             </div>
        </section>




        {/* 2. BRANDING: The Concept (Split Screen) */}
        <section class="border-b border-zinc-900 bg-zinc-950">
             <div class="grid grid-cols-1 md:grid-cols-2">
                 {/* Image Asset (Full Bleed) */}
                 <div class="relative aspect-[3/4] md:aspect-auto md:h-full overflow-hidden border-r border-zinc-900 reveal-img">
                     <Image 
                        src={asset1} 
                        alt="Pé de Café Branding Concept"
                        class="w-full h-full object-cover"
                     />
                 </div>
                 
                 {/* Text Content */}
                 <div class="p-8 md:p-24 md:pb-12 flex flex-col justify-center reveal-up delay-100">
                     <span class="font-mono text-xs text-zinc-500 uppercase tracking-widest mb-8">01 — O CONCEITO</span>
                     <h2 class="text-4xl md:text-6xl font-display font-bold text-white mb-8 leading-[1.1]">
                        A nossa mineiridade<br/> acolhedora
                     </h2>
                     <p class="font-serif text-zinc-400 leading-relaxed text-xl mb-12 max-w-lg">
                        Antes de desenvolver os sistemas, focamos em encontrar a alma do projeto. Através de posicionamento, estratégia e identidade visual, buscamos um conceito que transmitisse a mineiridade acolhedora do café.
                        <br/><br/>
                        O desafio era quebrar a formalidade de um concurso técnico. Unimos o estilo "Rubber Hose" dos anos 30 com a irreverência mineira, criando uma estética que gerou uma identificação imediata com o público.
                     </p>
                     {/* Stats */}
                     <div class="flex gap-16 border-t border-zinc-800 pt-12">
                         <div>
                             <span class="block text-4xl font-bold font-display text-white">27</span>
                             <span class="text-xs font-mono text-zinc-500 uppercase mt-2 block">Cafeterias</span>
                         </div>
                         <div>
                             <span class="block text-4xl font-bold font-display text-white">+24k</span>
                             <span class="text-xs font-mono text-zinc-500 uppercase mt-2 block">Votos</span>
                         </div>
                     </div>
                 </div>
             </div>
        </section>



        {/* Experience Context Image (Mobile Position) */}
        <section class="block md:hidden w-full h-[50vh] bg-zinc-950 border-b border-zinc-900 relative overflow-hidden">
             <Image 
                src={comboDesktop} 
                alt="Contexto Mesa Pé de Café Desktop"
                class="hidden md:block w-full h-full object-cover"
             />
             <Image 
                src={comboMobile} 
                alt="Contexto Mesa Pé de Café Mobile"
                class="block md:hidden w-full h-full object-cover"
             />
        </section>

        {/* 3. EXPERIENCE: From Table to Vote (Split Screen) */}
        <section class="border-b border-zinc-900 bg-black">
             <div class="grid grid-cols-1 md:grid-cols-2">
                 {/* Text Content (Left) */}
                 <div class="p-8 md:py-8 md:px-24 flex flex-col justify-center border-r border-zinc-900 order-2 md:order-1 reveal-up">
                     <span class="font-mono text-xs text-zinc-500 uppercase tracking-widest mb-8">02 — EXPERIÊNCIA</span>
                     <h2 class="text-4xl md:text-6xl font-display font-bold text-white mb-8">Da mesa ao voto</h2>
                     <p class="font-sans text-zinc-500 max-w-md leading-relaxed">
                        O jogo americano não funcionou apenas como suporte físico, mas como a interface de embarque. Ao escanear o QR Code, a transição para o digital é imperceptível.
                     </p>
                 </div>

                 {/* Visual Assets (Right - Desktop Image now) */}
                 <div class="hidden md:block relative w-full h-full bg-zinc-900/20 order-1 md:order-2 reveal-img border-b md:border-b-0 border-zinc-900 min-h-[500px] md:min-h-auto">
                     <Image 
                        src={comboDesktop} 
                        alt="Contexto Mesa Pé de Café Desktop"
                        class="w-full h-full object-cover"
                     />
                 </div>
             </div>
        </section>





        {/* 4. DIGITAL CHALLENGE (Editorial Grid) */}
        <section class="border-b border-zinc-900 bg-zinc-950/50">
            <div class="grid grid-cols-1 md:grid-cols-12 min-h-[400px]">
                {/* Sidebar Label */}
                <div class="md:col-span-4 p-8 md:p-24 border-r border-zinc-900 bg-zinc-900/30">
                    <span class="font-mono text-xs text-zinc-500 uppercase tracking-widest sticky top-32 block reveal-up">
                        03 — O DESAFIO
                    </span>
                </div>
                
                {/* Content */}
                <div class="md:col-span-8 p-8 md:p-24 flex items-center reveal-up delay-100">
                     <p class="text-2xl md:text-4xl leading-relaxed font-serif text-white text-balance">
                        {entry.data.challenge || entry.data.description}
                     </p>
                </div>
            </div>
        </section>

        {/* 4. The Immersive Gallery (Hero - Full Bleed - Mobile Only) */}
        <section class="block md:hidden w-full relative overflow-hidden bg-zinc-950 border-b border-zinc-900">
             <div class="w-full relative">
                 {/* Main Reveal Frame */}
                 <div class="relative aspect-[3/4] w-full overflow-hidden reveal-up">
                     <video
                        id="mobile-orbit-video"
                        src="/assets-dev/pedecafe/lottie/orbit_lite.webm"
                        class="w-full h-full object-cover"
                        autoplay
                        loop
                        muted
                        playsinline
                        preload="auto"
                     ></video>
                 </div>
             </div>
        </section>

        <script>
            // Aggressive Mobile Video Autoplay Fix
            document.addEventListener('astro:page-load', () => {
                const video = document.getElementById('mobile-orbit-video');
                if (!video) return;
                
                // Explicitly set text tracks/audio to allow autoplay policies
                video.muted = true;
                video.playsInline = true;

                // Force a reload of the media source to clear any SPA styling states
                video.load();

                const attemptPlay = async () => {
                    try {
                        const playPromise = video.play();
                        if (playPromise !== undefined) {
                            await playPromise;
                        }
                    } catch (error) {
                        // If blocked, wait for ANY user interaction
                        const forcePlayByUser = () => {
                            video.play().catch(e => console.error("User interaction play failed", e));
                            ['touchstart', 'touchend', 'click', 'scroll'].forEach(evt => 
                                document.removeEventListener(evt, forcePlayByUser)
                            );
                        };
                        
                        ['touchstart', 'touchend', 'click', 'scroll'].forEach(evt => 
                            document.addEventListener(evt, forcePlayByUser, { once: true, passive: true })
                        );
                    }
                };

                // Observer to only play when visible (saves resources but also triggers play)
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            attemptPlay();
                        } else {
                            video.pause();
                        }
                    });
                }, { threshold: 0.1 }); // Trigger as soon as 10% is visible

                observer.observe(video);
                
                // Fallback loop
                video.addEventListener('ended', () => {
                    video.currentTime = 0;
                    attemptPlay();
                });
            });
        </script>



        {/* Experience Context Lottie (Desktop Position - Between Challenge and Solutions) */}
        <section class="hidden md:block w-full h-[80vh] bg-zinc-950 border-b border-zinc-900 relative overflow-hidden">
             <dotlottie-player
                src="/assets-dev/pedecafe/lottie/desktop/slider_animation.lottie"
                background="transparent"
                speed="1"
                loop
                autoplay
                class="w-full h-full object-cover scale-150"
                style="width: 100%; height: 100%; object-fit: cover;"
             ></dotlottie-player>
        </section>

        {/* 04. SOLUTIONS (Horizontal Layout) */}
        <section class="border-b border-zinc-900 bg-black text-white">
            <div class="p-8 md:p-24 border-b border-zinc-900">
                <span class="font-mono text-xs text-zinc-500 uppercase tracking-widest block mb-16 reveal-up">
                    04 — SOLUÇÕES
                </span>

                <ul class="grid grid-cols-1 md:grid-cols-3 gap-12 list-none reveal-up delay-100">
                    <li class="border-t border-zinc-800 pt-8 md:border-none md:pt-0">
                        <div class="flex items-center gap-4 mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" class="w-8 h-8 text-zinc-500 shrink-0">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <strong class="text-white text-xl font-mono uppercase">Sistema de Votação Anti-Fraude</strong>
                        </div>
                        <p class="text-zinc-400 text-lg leading-relaxed">Implementação de lógica de validação robusta para garantir que cada voto fosse único e legítimo, evitando bots e manipulações que poderiam comprometer a idoneidade do concurso.</p>
                    </li>
                    <li class="border-t border-zinc-800 pt-8 md:border-none md:pt-0">
                        <div class="flex items-center gap-4 mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" class="w-8 h-8 text-zinc-500 shrink-0">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6a7.5 7.5 0 107.5 7.5h-7.5V6z" />
                              <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 10.5H21A7.5 7.5 0 0013.5 3v7.5z" />
                            </svg>
                            <strong class="text-white text-xl font-mono uppercase">Dashboard Administrativo</strong>
                        </div>
                        <p class="text-zinc-400 text-lg leading-relaxed">Desenvolvimento de um painel de controle intuitivo para a organização, permitindo o acompanhamento da apuração em tempo real, gestão de participantes e exportação de relatórios métricos.</p>
                    </li>
                    <li class="border-t border-zinc-800 pt-8 md:border-none md:pt-0">
                        <div class="flex items-center gap-4 mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" class="w-8 h-8 text-zinc-500 shrink-0">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
                            </svg>
                            <strong class="text-white text-xl font-mono uppercase">Performance e Disponibilidade</strong>
                        </div>
                        <p class="text-zinc-400 text-lg leading-relaxed">Arquitetura focada em velocidade de carregamento, garantindo experiência fluida no fluxo de votação mesmo sob alta demanda. <strong>Processamos milhares de votos com zero downtime.</strong></p>
                    </li>
                </ul>
            </div>

            {/* Mobile Lottie - Animation 2 */}
            <div class="block md:hidden w-full aspect-[9/16] bg-zinc-900/20 -my-32 relative z-0 pointer-events-none">
                 <dotlottie-player
                    src="/assets-dev/pedecafe/lottie/mobile/slider_animation.lottie"
                    background="transparent"
                    speed="1"
                    loop
                    autoplay
                    class="w-full h-full object-cover scale-110"
                    style="object-fit: cover;"
                 ></dotlottie-player>
            </div>

            {/* Live Preview Section */}
            <div class="grid grid-cols-1 md:grid-cols-2">
                <div class="p-8 pb-0 md:p-24 border-r border-zinc-900 bg-zinc-900/10">
                    <div class="sticky top-32 reveal-up">
                        <h3 class="text-4xl md:text-5xl font-display font-bold text-white mb-6">Cardápio Interativo</h3>
                        <p class="text-zinc-400 text-xl md:text-2xl leading-relaxed mb-8">
                            Este é um espelho real da aplicação desenvolvida para o cardápio do concurso. Você pode navegar livremente para explorar a interface.
                        </p>
                        <ul class="space-y-4 text-zinc-500 font-mono text-sm">
                            <li class="flex items-center gap-3">
                                <div class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></div>
                                Navegue pelos combos das cafeterias
                            </li>
                            <li class="flex items-center gap-3">
                                <div class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></div>
                                Consulte endereços e mapas
                            </li>
                            <li class="flex items-center gap-3">
                                <div class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></div>
                                Experimente a fluidez da navegação
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="p-6 pt-16 md:p-24 bg-zinc-950 flex justify-center items-start">
                    <div class="w-full max-w-md mx-auto reveal-up delay-200">
                        <ScrollingPrototype 
                            url="https://pede.cafe/cardapio" 
                            title="CARDÁPIO INTERATIVO"
                            height="aspect-[9/16]"
                            loading="eager"
                            skipLink="#next-section"
                        />
                    </div>
                </div>
            </div>
        </section>



        {/* Outcome Section (Editorial Grid) */}
        {entry.data.outcome && (
            <section id="next-section" class="border-b border-zinc-900 bg-zinc-950/30">
                <div class="grid grid-cols-1 md:grid-cols-12 min-h-[400px]">
                    <div class="md:col-span-4 p-8 md:p-12 border-r border-zinc-900">
                        <span class="font-mono text-xs text-zinc-500 uppercase tracking-widest sticky top-32 block reveal-up">
                            05 — RESULTADOS
                        </span>
                    </div>
                    <div class="md:col-span-8 p-8 md:p-24 flex items-center reveal-up delay-100">
                        <p class="text-lg md:text-4xl font-mono leading-relaxed text-white">
                            "{entry.data.outcome}"
                        </p>
                    </div>
                </div>
            </section>
        )}

        {/* Next Level CTA Footer */}
        <section class="relative w-full h-[60vh] md:h-[80vh] overflow-hidden group border-t border-zinc-900 bg-black">
             
             <div class="absolute inset-0 z-0 text-white/5 pointer-events-none flex items-center justify-center overflow-hidden">
                <span class="text-[30vw] font-black uppercase tracking-tighter opacity-10 blur-sm">PRIMITIVA</span>
             </div>

             <div class="absolute inset-0 z-0">
                 {/* Background Accent */}
                 <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-blue-950/20 via-transparent to-transparent opacity-50 group-hover:opacity-80 transition-opacity duration-700"></div>
                 <div class="absolute inset-0 bg-black/40 group-hover:bg-black/20 transition-colors duration-700"></div>
             </div>
             
             <div class="absolute inset-0 flex flex-col items-start justify-center z-10 p-8 md:p-12 lg:p-24 pointer-events-none">
                 <span class="font-mono text-[10px] md:text-xs uppercase tracking-[0.5em] text-zinc-500 mb-8 transition-colors bg-white/5 px-4 py-2 border border-white/10 rounded-full group-hover:text-white group-hover:border-white/30">
                    PRÓXIMO PROJETO
                 </span>
                 <h2 class="font-display font-black text-[20vw] md:text-[15vw] text-white uppercase tracking-tighter leading-[0.8] mb-12 transition-transform duration-700 group-hover:scale-[1.02]">
                      O SEU.
                 </h2>
                 <div class="w-full md:w-auto pointer-events-auto">
                    <a
                        href="/briefing/"
                        class="w-full md:w-auto px-8 h-16 text-lg font-black uppercase tracking-widest flex items-center justify-center gap-2 
                                bg-white text-black border-2 border-black shadow-[6px_6px_0px_0px_rgba(255,255,255,1)] 
                                hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-[4px_4px_0px_0px_rgba(255,255,255,1)] 
                                transition-all duration-200"
                    >
                        <span class="font-mono flex items-center">
                            {`> INICIAR_PROJETO`}
                            <span class="animate-blink">_</span>
                        </span>
                    </a>
                 </div>
             </div>
        </section>

        <style>
            @keyframes blink {
                0%, 100% { opacity: 1; }
                50% { opacity: 0; }
            }
            .animate-blink {
                animation: blink 0.8s infinite;
            }
        </style>

    </main>
</WebLayout>

<script>
    // Animation Observer
    const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('active');
            }
        });
    }, observerOptions);

    document.addEventListener('astro:page-load', () => {
        const elements = document.querySelectorAll('.reveal-up, .reveal-text, .reveal-img, .line-grow');
        elements.forEach(el => observer.observe(el));
    });
</script>
